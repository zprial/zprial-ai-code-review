# Story 2.4: Review Detail UI Experience

## Status
Ready

## Story
**As a** 开发者,
**I want** 在审查详情页高效查看并处理 AI 评论,
**so that** 可以快速理解风险、执行修复或请求人工复核。
**Dependencies:** Stories 1.0 Foundation & UI Shell, 2.2 Graded Feedback & Blocking, 3.5 Dashboard & Notifications UI

## Acceptance Criteria
1. 审查详情页展示 MR 摘要（仓库、作者、状态、阻断/警告统计、更新时间）并提供返回列表的 Breadcrumb。
2. 评论按照严重度分组，卡片包含严重度徽章、来源（规则/LLM）、引用代码片段、建议文本、证据链接及操作按钮（标记已处理、请求人工复核、复制建议、跳转 Git）。
3. 页面右侧或顶部显示审查任务时间线（排队→处理中→完成/失败）、重新审查倒计时、告警提示；失败或缺失 LLM 结果时提供降级提示。
4. 支持状态反馈：操作按钮触发后显示 Loading/成功/错误提示，阻断项处理完成后立即更新统计数据。

## Tasks / Subtasks
- [ ] 构建审查详情布局与 Breadcrumb（AC: 1）
  - [ ] 渲染 MR 元信息、返回入口与状态徽章（AC: 1）
  - [ ] 实现面包屑导航与响应式布局（AC: 1）
- [ ] 实现分组评论列表与卡片交互（AC: 2）
  - [ ] 严重度分组折叠/展开、卡片操作按钮、代码片段高亮（AC: 2）
  - [ ] 支持复制建议、跳转 Git URL、显示来源标签（AC: 2）
- [ ] 构建任务时间线与状态面板（AC: 3）
  - [ ] 展示队列阶段、开始/完成时间、倒计时（AC: 3）
  - [ ] 处理 LLM 缺失或失败时的提醒与降级说明（AC: 3）
- [ ] 加入操作反馈与状态同步（AC: 4）
  - [ ] 操作期间的 Loading/成功/失败 Toast 或 Banner（AC: 4）
  - [ ] 成功后刷新统计与卡片状态（AC: 4）

## Dev Notes
- 参照 `docs/front-end-spec.md#review-detail-ui` 的审查详情布局与组件说明，重用评论卡片、严重度徽章、操作按钮样式。
- 数据接口使用 `docs/architecture.md:162-175` 所定义的反馈 API；确保前端在调用后遵循防抖/重试策略，并在处理成功后同步刷新 Dashboard（Story 3.5）。
- 处理大数量评论时注意性能，可按严重度懒加载或虚拟滚动。
- 失败或降级信息需与 Runbook 告警文案一致（见 `docs/runbook.md:66-88`）。

### Testing
- 编写组件测试覆盖分组展开、操作按钮、错误状态；E2E 测试验证从 Dashboard 进入审查详情的完整路径。
- 验证无权限用户访问时的提示（依赖 Story 1.0 角色守卫）。
- 手动测试移动端折叠布局与交互按钮可点区域。

## Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2025-10-18 | 0.1 | 初始草稿 | PO Sarah |
| 2025-10-20 | 0.2 | Status set to Ready | PO Sarah |

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results
