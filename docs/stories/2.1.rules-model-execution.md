# Story 2.1: Rules Model Execution

## Status
Draft

## Story
**As a** 审查工程师,
**I want** 将静态规则与 AI 推理结合,
**so that** 能全面检测语法、逻辑、安全等问题。

## Acceptance Criteria
1. 支持配置检测类别（语法、逻辑、安全、风格等）并组合执行。
2. AI 推理结果需包含疑似问题位置、理由与置信度。
3. 将规则与模型结果合并为统一结构，供后续分级与评论模板化使用。

## Tasks / Subtasks
- [ ] 实现检测类别配置与执行编排（AC: 1）
  - [ ] 定义检测类型枚举与启用开关（AC: 1）
  - [ ] 支持按 MR 触发动态组合执行顺序（AC: 1）
- [ ] 集成 AI 推理接口并标准化返回值（AC: 2）
  - [ ] 获取问题位置、理由、置信度等字段（AC: 2）
  - [ ] 处理推理失败与重试策略（AC: 2）
- [ ] 合并规则与 AI 结果形成统一结构（AC: 3）
  - [ ] 设计输出 Schema 兼容后续分级处理（AC: 3）
  - [ ] 保留来源信息以便追踪（AC: 3）

## Dev Notes
- 静态规则可调用内部 linters/静态分析工具，AI 部分调用内部 LLM 服务。
- 合并结果需保留检测来源，便于调试与准确率分析。
- 注意执行顺序与资源控制，避免对队列造成阻塞。

### Testing
- 单元测试覆盖配置解析、规则执行结果合并逻辑。
- 集成测试模拟多种检测组合与 AI 调用超时情境。
- 构建置信度与问题位置的契约测试，确保后续模块可消费。

## Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2025-10-18 | 0.1 | 初始草稿 | PO Sarah |

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results

